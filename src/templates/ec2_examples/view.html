{% extends "base.html" %}
{% block content %}
    <form action='{{url_for("ec2_list")}}' method='get'>
        <input type='submit' value='Back' />
    </form>

    <table>
        <tr><td>ID</td><td> {{ instance.id }}</td></tr>
        <tr><td>Image AMI ID</td><td> {{ instance.image_id }}</td></tr>
        <tr><td>Key Pair </td><td> {{ instance.key_name }}</td></tr>
        <tr><td>Public IP Address</td><td>{{ instance.public_ip_address }}</td></tr>
        <tr><td>State</td><td>{{ instance.state['Name'] }}</td></tr>
    </table>


    <h2>CPU</h2>

    <div id="cpu_plot" style="width:300px;height:150px"></div>

    <h2>Requests per Minute</h2>

    <div id="http_plot" style="width:300px;height:150px"></div>

    <script>

        let now = Date.now()
        const options = {
            series: {
                lines: {show: true},
                points: {show: true}
            },
            xaxis: {
                mode: "time",
                timeBase: "milliseconds",
                timeformat: "%H:%M",
                minTickSize: [1, "minute"],
                min: new Date(now - 30*60*1000).getTime(), //30 minutes ago,
                max: now
            }
        };


        $.plot($("#cpu_plot"), [ {{ cpu_stats }} ] , options);
        $.plot($("#http_plot"), [ {{ http_stats }} ] , options);
    </script>

{% endblock %}